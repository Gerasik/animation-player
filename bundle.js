!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);class s{constructor(e){this.className=e,this.block=null}render(){const e=document.createElement("header");e.classList.add(this.className),e.innerHTML=`<button class="${this.className}__menu-button"><div></div><div></div><div></div></button>\n                        <h1 class="${this.className}__title">CodeJam - Animation Player</h1>\n                        <button class="${this.className}__position"><div></div><div></div><div></div></button>`,document.body.appendChild(e),this.block=e}}class n{constructor(e){this.className=e,this.block=null}render(){const e=document.createElement("section");e.classList.add(this.className),document.body.appendChild(e),this.block=e}}class i{constructor(e,t){this.className=e,this.parentBlock=t,this.block=null}render(){const e=document.createElement("section"),t=document.createElement("div");e.classList.add(this.className),t.classList.add(`${this.className}__bar`),[{name:"pen",icon:"f304;"},{name:"fill",icon:"f576"},{name:"eraser",icon:"f12d"},{name:"line",icon:"f304"}].forEach(e=>i.addTool(e,t,this.className)),e.appendChild(t),this.parentBlock.appendChild(e)}static addTool(e,t,a){const s=document.createElement("button");s.classList.add(`${a}__item`),s.classList.add(`${a}__${e.name}`),s.innerHTML=`<span>&#x${e.icon}</span>`,t.appendChild(s)}}class r{constructor(e,t){this.frames=[],this.className=e,this.parentBlock=t,this.block=null,this.current=null}render(){const e=document.createElement("section");e.classList.add(this.className),e.innerHTML=`<div class="${this.className}__add-frame">\n                              <span>&#xf067</span>\n                              <span>Add new frame</span>\n                           <div>`,this.parentBlock.appendChild(e),this.block=e,0===this.frames.length&&this.createFrame()}createFrame(e){const t=document.createElement("div"),a=document.createElement("canvas"),s=document.createElement("span"),n=document.createElement("span"),i=document.createElement("span");return a.setAttribute("width",20),a.setAttribute("height",20),s.classList.add(`${this.className}__number`),n.classList.add(`${this.className}__remove`),i.classList.add(`${this.className}__copy`),s.innerHTML=this.block.childElementCount,n.innerHTML="&#xf2ed",i.innerHTML="&#xf0c5",t.classList.add(`${this.className}__frame`),t.appendChild(s),t.appendChild(n),t.appendChild(i),t.appendChild(a),e?e.parentElement.insertBefore(t,e.nextSibling):this.block.insertBefore(t,this.block.lastChild),this.togletCurrFrame(t),t}togletCurrFrame(e){this.current&&this.current.classList.remove("frame-list__curr-frame"),e.classList.add(`${this.className}__curr-frame`),this.current=e}createCopyFrame(e){const t=this.createFrame(e),a=t.getElementsByTagName("canvas")[0],s=e.getElementsByTagName("canvas")[0],n=s.getContext("2d").getImageData(0,0,s.width,s.height);return a.getContext("2d").putImageData(n,0,0),this.togletCurrFrame(t),t}updateCount(){const e=this.block.children;for(let t=1;t<e.length;t+=1){e[t-1].querySelector(".frame-list__number").innerHTML=t}}}class c{constructor(e,t){this.className=e,this.parentBlock=t,this.block=null}render(){const e=document.createElement("section"),t=document.createElement("canvas"),a=document.createElement("canvas");t.setAttribute("width",20),t.setAttribute("height",20),t.classList.add(`${this.className}__canvas-image`),t.classList.add("canvas-image"),a.setAttribute("width",20),a.setAttribute("height",20),a.classList.add(`${this.className}__canvas-prev`),a.classList.add("canvas-prev"),e.classList.add(this.className),e.appendChild(t),e.appendChild(a),this.parentBlock.appendChild(e),this.block=e}}class l{constructor(e,t,a){this.className=e,this.parentBlock=t,this.sizeCanvas=a,this.block=null}render(){const e=document.createElement("section");e.classList.add(this.className),e.innerHTML=`<canvas class="${this.className}__player" width="${this.sizeCanvas.width}" height="${this.sizeCanvas.height}"></canvas>\n                                <span class="${this.className}__full-size">&#xf066</span>\n                                <span class="${this.className}__number">FPS: 12</span>\n                                <input class="${this.className}__frequency" type="range" min="1" max="24" value="12" step="1">`,this.parentBlock.appendChild(e),this.block=e}}class o{constructor(e){this.className=e,this.currentTool="pen",this.dataImage=null,this.count=0,this.frequency=12}start(){new s("page-header").render();const e=new n("container");e.render(),new i("tools",e.block).render();const t=new r("frame-list",e.block);t.render();const a=new c("main-canvas",e.block);a.render(),t.block.addEventListener("click",o.eventFrameList.bind(t)),a.block.querySelector(".canvas-prev").addEventListener("mousemove",e=>{const t=e.target.getContext("2d");t.clearRect(0,0,e.target.width,e.target.height);const s=Math.floor(e.offsetX/(e.target.clientWidth/e.target.width)),n=Math.floor(e.offsetY/(e.target.clientHeight/e.target.height));t.fillStyle="#8885",t.fillRect(s,n,1,1),a.block.querySelector(".canvas-prev").addEventListener("mouseleave",()=>t.clearRect(0,0,e.target.width,e.target.height))});const d=new l("animation-player",e.block,{width:20,height:20});d.render(),d.block.addEventListener("input",e=>{const t=e.target.value;e.target.previousElementSibling.innerText=`FPS: ${t}`,this.frequency=t}),d.block.addEventListener("click",e=>{"full-size"===e.target.className.split("__")[1]&&d.block.requestFullscreen()}),this.dataImage=o.getFramesData();const m=()=>{const e=this.dataImage,t=e[this.count%e.length];d.block.getElementsByTagName("canvas")[0].getContext("2d").putImageData(t,0,0),this.count+=1,setTimeout(m,1e3/this.frequency)};setTimeout(m,1e3/this.frequency),a.block.querySelector(".canvas-prev").addEventListener("mousedown",()=>{a.block.querySelector(".canvas-prev").addEventListener("mousemove",o.draw),a.block.querySelector(".canvas-prev").addEventListener("mouseup",()=>{this.dataImage=o.getFramesData(),a.block.querySelector(".canvas-prev").removeEventListener("mousemove",o.draw)}),a.block.querySelector(".canvas-prev").addEventListener("mouseleave",()=>{this.dataImage=o.getFramesData(),a.block.querySelector(".canvas-prev").removeEventListener("mousemove",o.draw)})})}static draw(e){const t=Math.floor(e.offsetX/(e.target.clientWidth/e.target.width)),a=Math.floor(e.offsetY/(e.target.clientHeight/e.target.height)),s=document.querySelector(".canvas-image"),n=s.getContext("2d"),i=n.getImageData(0,0,s.width,s.height);document.querySelector(".frame-list__curr-frame").getElementsByTagName("canvas")[0].getContext("2d").putImageData(i,0,0),n.fillStyle="#000",n.fillRect(t,a,1,1)}static eventFrameList(e){if("SECTION"!==e.target.tagName){let t=e.target;for(;"DIV"!==t.tagName;)t=t.parentElement;if("add-frame"===t.className.split("__")[1]){this.createFrame();const e=document.querySelector(".frame-list__curr-frame").getElementsByTagName("canvas")[0],t=e.getContext("2d").getImageData(0,0,e.width,e.height);o.updateMainCanvas(t)}else if("frame"===t.classList[0].split("__")[1])if("copy"===e.target.className.split("__")[1]){this.createCopyFrame(t);const e=t.getElementsByTagName("canvas")[0],a=e.getContext("2d").getImageData(0,0,e.width,e.height);o.updateMainCanvas(a),this.updateCount()}else if("remove"===e.target.className.split("__")[1]){let e;t.previousSibling?e=t.previousSibling:t.nextSibling&&"frame-list__add-frame"!==t.nextSibling.className?e=t.nextSibling:"frame-list__add-frame"===t.nextSibling.className&&(e=this.createFrame()),this.togletCurrFrame(e);const a=e.getElementsByTagName("canvas")[0],s=a.getContext("2d").getImageData(0,0,a.width,a.height);o.updateMainCanvas(s),t.remove(),this.updateCount()}else{this.togletCurrFrame(t);const e=t.getElementsByTagName("canvas")[0],a=e.getContext("2d").getImageData(0,0,e.width,e.height);o.updateMainCanvas(a)}}}static updateMainCanvas(e){document.querySelector(".canvas-image").getContext("2d").putImageData(e,0,0)}static getFramesData(e){const t=e||document.querySelector(".frame-list"),a=[];for(let e=0;e<t.children.length-1;e+=1){const s=t.children[e].getElementsByTagName("canvas")[0],n=s.getContext("2d");a.push(n.getImageData(0,0,s.width,s.height))}return a}}a(1);new o("Piskel").start()},function(e,t){}]);
//# sourceMappingURL=bundle.js.map